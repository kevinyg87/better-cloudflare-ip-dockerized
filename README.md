check https://github.com/badafans/better-cloudflare-ip for more detail.